
<!DOCTYPE html>
<!--
TODO:
- Nauczyciele po najechaniu na lekcje,
- Ustawienia grup,
- Przyciski,
- Zastępstwa.
-->
<html lang="pl">
    <head>
        <meta charset="utf-8">
        <meta name="author" content="fileq">
        <link rel="stylesheet" href="style.css">
        <link href="https://fonts.googleapis.com/css?family=Francois+One|Open+Sans+Condensed:300&amp;subset=latin-ext" rel="stylesheet">
        <link rel="icon" type="image/png" href="images/favico.png">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="refresh" content="30">
        <title>Plan Lekcji 1G Sieniu</title>
        <script type="text/javascript">
           var currentDate = new Date();
            //  currentDate.setHours(8, 30);
            //  currentDate.setDate(14);
           console.log(currentDate);
           function day()
           {
               var numDay = currentDate.getDay();
               switch (numDay)
               {
                   case 0: return "Niedziela"
                   break;
                   case 1: return monday
                   break;
                   case 2: return tuesday
                   break;
                   case 3: return wednesday
                   break;
                   case 4: return thursday
                   break;
                   case 5: return friday
                   break;
                   case 6: return "Sobota"
                   break;
               };
           }
           
           function plan(poczatek, dzien, lekcje, sala)
           {
               this.poczatek = poczatek;
               this.dzien = dzien;
               this.lekcje = lekcje;
               this.sala = sala;
           }
           
           var monday = new plan(1, "Poniedziałek", ["J. Francuski (roz)", "Religia", "Matematyka", "WOK", "J. polski", "J. angielski"], ["31", "41?", "61", "17", "?", "31/49"]);
           var tuesday = new plan(1, "Wtorek", ["Godzina wychowawcza", "J. angielski / Informatyka", "Informatyka / J. ang", "Matematyka", "Historia", "W-F","Jezyk Niemiecki / J. Francuski (podst.)"], ["31", "45/31", "45/30", "61", "71", "-", "57/42/10//34"]);
           var wednesday = new plan(0, "Środa", ["W-F", "EDB", "Religia", "Chemia", "J. polski", "Matematyka", "Matematyka"], ["-", "11", "54A?", "54", "70", "61", "61"]);
           var thursday = new plan(1, "Czwartek", ["WOS", "Biologia", "J. angielski", "W-F", "PP", "Historia"], ["41", "71", "31/57", "-", "68", "71"]);
           var friday = new plan(0, "Piątek", ["J. Niemiecki", "PP", "Fizyka", "Matematyka", "Geografia", "J. polski", "J. polski", "J. Francuski"], ["57/42/10", "41", "13", "61", "41", "54", "54", "34/37"]);
           
           function checkGroupName(value) {
               if(value == 1)
                   {
                       var groupEng = document.getElementById("ang");
                       var selectedEng = groupEng.options[groupEng.selectedIndex].value;
                       if(selectedEng == "zaaw")
                           {
                               console.log("Grupa pani Sejdak");
                           }
                       else
                           {
                               console.log("Grupa pani Ciesielskiej");
                           }
                   }
                else
                {
                     var groupDeu = document.getElementById("niem");
                     var selectedDeu = groupDeu.options[groupDeu.selectedIndex].value;

                     switch(selectedDeu)
                       {
                           case "deu1":
                               console.log("Borkowska");
                               break;
                           case "deu2":
                               console.log("Górska");
                               break;
                           case "deu3":
                               console.log("Ulatowska");
                               break;
                           case "fra1":
                               console.log("francuski 1");
                               break;
                           case "fra2":
                               console.log("francuski 2");
                               break;
                       }
                }   
           }
           
           function customTime(hours, minutes)
               {
                   var custom = new Date();
                   custom.setHours(hours, minutes, 0);
                   custom = custom.getHours()*60 + custom.getMinutes();
                   return custom;
               }
               
               var lessonHours = [customTime(7, 40), customTime(8, 30), customTime(9, 25), customTime(10, 20), customTime(11, 25), customTime(12, 20), customTime(13, 15), customTime(14, 10), customTime (15, 0)];
               
               var endHours = [customTime(08, 25), customTime(09, 15), customTime(10, 10), customTime(11, 05), customTime(12, 10), customTime(13,05), customTime(14, 00), customTime(14, 55)];
           
           function checkLesson(abc)
           {
               var time = currentDate.getHours()*60 + currentDate.getMinutes();
               
               var lessonHour;
               
               if(time < lessonHours[abc.poczatek]||time >= endHours[abc.lekcje.length + abc.poczatek- 1])
                   {
                       return ["Brak lekcji", 0, 0]
                   }
               else
                  {
                      
                      if(lessonHours.indexOf(time) == -1)
                        {
                            var x = lessonHours.find(function(l){ return l >= time});
                            var xd = endHours.find(function(l){return l >= time})
                            if(endHours.indexOf(time) !== -1 || xd > x)
                                {
                                    lessonHour = lessonHours.indexOf(x) - 1;
                                    lessonHour = lessonHour - abc.poczatek;
                                    salaNumber = abc.sala[lessonHour];
                                    return ["Przerwa", lessonHour, salaNumber];
                                }
                            else
                                {
                                    lessonHour = lessonHours.indexOf(x) - 1;
                                    lessonHour = lessonHour - abc.poczatek;
                                    salaNumber = abc.sala[lessonHour];
                                    return [abc.lekcje[lessonHour], lessonHour, salaNumber];
                                }
                        }
                      else
                        {
                            lessonHour = lessonHours.indexOf(time);
                            lessonHour = lessonHour - abc.poczatek;
                            salaNumber = abc.sala[lessonHour];
                            return [abc.lekcje[lessonHour], lessonHour, salaNumber];
                        }
                  }
           }
           
           function nextLessons(abc)
           {
               var huj = checkLesson(abc)[0];
               var lessonsToday = abc.lekcje;
               var roomsToday = abc.sala;
               var lessonsToRemove = checkLesson(abc)[1];
               lessonsToday.splice(0, lessonsToRemove + 1);
               roomsToday.splice(0, lessonsToRemove + 1);
               if(lessonsToday.length == 0 || huj == "Brak lekcji") 
               {
                   return "Brak";
               }
               else
               { 
                   var value = "<ul>";
                   for(i=0; i < lessonsToday.length; i++)
                   {
                       value += "<li>" + lessonsToday[i] + " | " + roomsToday[i] + "</li>";
                   }

                   return value;
               }
           }
           
           function timeToAlert(xddd)
           {
               var time = currentDate.getHours()*60 + currentDate.getMinutes();
               if(checkLesson(xddd)[0] == "Przerwa")
                   {
                       var toNextLessons = lessonHours[checkLesson(xddd)[1] + xddd.poczatek + 1];
                       return toNextLessons - time + "min";
                   }
               else if(checkLesson(xddd)[0] !== "Brak lekcji")
               {
                   console.log(checkLesson(xddd)[0]);
                   var toNextBreak = endHours[checkLesson(xddd)[1] + xddd.poczatek];
                   return toNextBreak - time + " min";
               }
               else
                   {
                       return "-";
                   }
           }
           
           function hideOnOff()
           {
               var hiddenElement = document.getElementById("check");
               if(hiddenElement.style.display === "none")
                   {
                       hiddenElement.style.display = "block";
                   }
               else
                   {
                       hiddenElement.style.display = "none";
                   }
           }
           
           document.addEventListener('DOMContentLoaded', function() {
               function leadingZero(i) {
                    return (i < 10)? '0'+i : i; 
                        }   
               var todayDate = leadingZero(currentDate.getDate()) + "." + leadingZero((currentDate.getMonth() + 1)) + "." + currentDate.getFullYear();
               document.getElementById("date").innerHTML = todayDate + " /";
               var currenttime = leadingZero (currentDate.getHours()) + ":" + leadingZero(currentDate.getMinutes());
               document.getElementById("whatTime").innerHTML = currenttime;
               var today = day();
               if(today !== "Niedziela" && day() !== "Sobota")
                   {
                       document.getElementById("day").innerHTML = today.dzien + " /";
                       document.getElementById("lesson").innerHTML = checkLesson(today)[0];
                       document.getElementById("room").innerHTML = checkLesson(today)[2];
                       document.getElementById("lesson-lists").innerHTML = nextLessons(today) + "</ul>";
                       document.getElementById("to").innerHTML = timeToAlert(today);
                   }
               else
               {
                   document.getElementById("day").innerHTML = today + " /";
                   document.getElementById("actual").innerHTML = "Dzień wolny od szkoły";
                   document.getElementById("hide").innerHTML = " ";
               }
               
            }, false);   
        </script>
    </head>
    <body>
        <header id="header">
            <h1>PLAN LEKCJI</h1>
            <h2>1G Sienkiewicz</h2>
        </header>
        <nav id="nav">
            <ul>
                <li><a href="#" onclick="setDate(11, 09, 30);">DZISIAJ</a></li>
                <li><a href="#">JUTRO</a></li>
                <li><a href="https://docs.google.com/spreadsheets/d/1r6wlsbIxKxCQwsvIINGXVEkhs6x3M_PydAI_BreHbeQ/edit#gid=0">CAŁY PLAN</a></li>
            </ul>
        </nav>
        <div id="container">
        <section id="content">
            <article id="today">
                <div class="time"><h2>Dziś jest:</h2> <div id="day">x</div> <div id="date">x</div> <div id="whatTime">x</div></div>
                <div class="time tomorrow"><h2>Wybrany dzień:</h2> <div id="day">x</div> <div id="date">x</div> <div id="whatTime">x</div></div>
                <div id="checkform">
                   <h2>Wybór grup:</h2>
                   <h3 onclick="hideOnOff();">Angielski: grupa 1 | Niemiecki: grupa 1 &#8801;</h3>
                   <ul id="check">
                   <li>Język angielski:</li>
                    <form>
                          <select id="ang" name="ang" onchange="checkGroupName(1)" disabled>
                            <option value="zaaw">grupa 1 - prof. Joanna Sejdak</option>
                            <option value="podst">grupa 2 - prof. Sylwia Ciesielska</option>
                          </select>
                    </form>
                    <li>Język niemiecki/francuski:</li>
                    <form>
                        <select id="niem" name="niem" onchange="checkGroupName(2)" disabled>
                            <option value="deu1">(niemiecki) grupa 1 - prof. Beata Borkowska</option>
                            <option value="deu2">(niemiecki) grupa 2 - prof. Magdalena Górska</option>
                            <option value="deu3">(niemiecki) grupa 3 - prof. Agnieszka Ulatowska</option>
                            <option value="fra1">(francuski) podstawa</option>
                            <option value="fra2">(francuski) rozszerzenie</option>
                        </select>
                    </form>
                    </ul>
                </div>
                <div id="info">
                <h2 id="actual">AKTUALNIE TRWA: <span id="lesson"></span> | SALA: <span id="room"></span></h2>
                    <div id="hide">
                        <h2 id="break" class="hideOnTomorrow">DO DZWONKA POZOSTAŁO: <span id="to"></span></h2>
                        <h2 id="next">KOLEJNE LEKCJE DZISIAJ:</h2>
                        <div id="lesson-lists"></div>
                    </div>
                </div>
            </article>
        </section>
        <article class="ads">
                <a href="https://www.youtube.com/watch?v=GC5n5UwLX8A"><img src="images/starypijany.jpg" alt="pawel jumper"></a>
            </article>
        </div>
        <footer id="footer">code/design_Filip Stanisławski</footer>
    </body>
</html>